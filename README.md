# 1C:Help Book (HBK) Viewer

**1C:Help Book (HBK) Viewer** — это инструмент для просмотра документации 1С:Предприятие из HBK (Help Book) файлов. Приложение предоставляет удобный веб-интерфейс для чтения страниц документации и навигации по оглавлению.

![Screenshot](doc/asserts/preview.png)

## Обзор

Приложение предназначено для просмотра документации платформы 1С:Предприятие из HBK файлов, позволяя читать страницы документации по имени и получать структуру оглавления через современный веб-интерфейс.

В одном окне приложения можно просматривать все доступные книги документации 1С:Предприятие. Вы можете легко переключаться между различными HBK файлами и получать быстрый доступ к любой нужной документации без необходимости открывать отдельные приложения или файлы.

Подробное описание формата HBK файлов и их структуры доступно в [документации по формату HBK](doc/hbk-format.md).

![Выбор файла](doc/asserts/select-book.png)

*Диалог выбора HBK файла. В одном окне можно просматривать любые доступные книги документации.*

### Возможности

- **Чтение страниц по имени** — получение HTML содержимого страниц документации из HBK файла
- **Чтение оглавления** — получение структуры оглавления (TOC) с иерархией страниц
- **Поиск страниц** — поиск страниц по русскому или английскому названию
- **Веб-интерфейс** — современное веб-приложение на TypeScript/React для просмотра документации
- **Запуск в Docker** — [подробная информация о запуске приложения в Docker контейнере](doc/docker.md)
- **Отображение версий** — автоматическое определение и отображение версии приложения и платформы 1С

Проект использует Spring Boot на базе Kotlin для бэкенда и React + TypeScript для фронтенда.

## История изменений

Все изменения проекта документированы в [CHANGELOG.md](doc/CHANGELOG.md).

## Требования

### Системные требования

- **Java**: версия 17 или выше

## Сборка

Проект собирается с помощью Gradle. Для сборки выполните следующую команду в корневой директории проекта:

```bash
./gradlew build
```

После успешной сборки исполняемый JAR-файл будет находиться в директории `build/libs/`.

## Использование

Приложение поддерживает два режима работы через CLI команды:
- **server** — запуск веб-сервера для просмотра документации
- **export** — экспорт HBK файлов в файловую систему

### Команда server

Запускает web сервер приложения.

**Синтаксис:**

```bash
java -jar hbk-reader-<версия>.jar server [опции]
```

**Опции:**

- `--platform-path`, `-p` - путь к каталогу установки 1С Предприятия (для автоматического поиска HBK файла)
- `--verbose`, `-v` - включить отладочное логирование

**Примеры:**

```bash
# Основной способ запуска
java -jar hbk-reader-0.2.0.jar server --platform-path "/opt/1cv8/x86_64/8.3.25.1257"

# Сокращенная форма
java -jar hbk-reader-0.2.0.jar server -p "/opt/1cv8/x86_64/8.3.25.1257"

# С отладочным логированием
java -jar hbk-reader-0.2.0.jar server -p "/opt/1cv8/x86_64/8.3.25.1257" --verbose
```

### Команда export

Экспортирует HBK файл в указанную директорию.

**Синтаксис:**

```bash
java -jar hbk-reader-<версия>.jar export --file <путь-к-hbk> --output <директория> [опции]
```

**Опции:**

- `--file`, `-f` - путь к HBK файлу для экспорта (обязательно)
- `--output`, `-o` - директория для сохранения распакованных файлов (обязательно)
- `--pages-only`, `-p` - экспортировать только HTML страницы (по умолчанию: false)
- `--include-toc`, `-t` - включить оглавление в экспорт, только для полного экспорта (по умолчанию: true)
- `--preserve-structure`, `-s` - сохранить структуру каталогов, только для pages-only (по умолчанию: true)

**Примеры:**

```bash
# Полный экспорт HBK файла
java -jar hbk-reader-0.2.0.jar export \
  --file "/path/to/platform.hbk" \
  --output "/path/to/output"

# Экспорт только HTML страниц
java -jar hbk-reader-0.2.0.jar export \
  --file "/path/to/platform.hbk" \
  --output "/path/to/output" \
  --pages-only

# Экспорт страниц без сохранения структуры каталогов
java -jar hbk-reader-0.2.0.jar export \
  --file "/path/to/platform.hbk" \
  --output "/path/to/output" \
  --pages-only \
  --preserve-structure false

# Полный экспорт без оглавления
java -jar hbk-reader-0.2.0.jar export \
  --file "/path/to/platform.hbk" \
  --output "/path/to/output" \
  --include-toc false
```

Для получения справки по конкретной команде используйте:

```bash
java -jar hbk-reader-0.2.0.jar <команда> --help
```

## Веб-приложение

Проект включает веб-интерфейс для удобного просмотра содержимого HBK файлов.

### Запуск веб-приложения

1. Перейдите в директорию `web/`:

   ```bash
   cd web
   ```

2. Установите зависимости:

   ```bash
   npm install
   ```

3. Запустите dev-сервер:

   ```bash
   npm run dev
   ```

Веб-приложение будет доступно по адресу `http://localhost:3000`

**Важно:** Убедитесь, что бэкенд приложение (Spring Boot) запущено на порту 8080.

### Сборка веб-приложения

```bash
cd web
npm run build
```

Собранные файлы будут в директории `web/dist/`.

Подробную информацию о веб-приложении смотрите в [web/README.md](web/README.md).

## Зависимости

Основные зависимости проекта:

- Spring Boot 3.5.0
- Kotlin с Coroutines
- Jackson (для работы с JSON)
- Apache Commons Compress (для работы с архивами)
- Logback для логирования

## Лицензия

Этот проект распространяется под лицензией MIT. Подробную информацию смотрите в файле [LICENSE](LICENSE).
